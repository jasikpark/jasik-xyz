
angular.module('app')
    .directive('translateContent', function ($sce, translationService) {
        return {
            restrict: 'E,A',
            scope: {
                container: '@container', // The key container (used to allow the same key to be translated differently for different containers)
                key: '@key',  // The key of the translatable content
                defaultContent: '@defaultContent'   // The default content in case the key does not return any content and to help make the implementation human-readable/searchable                
            },
            template: '<span ng-bind-html="showContent()"></span>',
            link: function (scope, element, attrs) {                                
                scope.translations = translationService.translations;       

                scope.showContent = function () {
                    if (scope.translations == undefined) {
                        return scope.defaultContent;
                    }
                    else if (scope.translations[scope.container] == undefined) {
                        return scope.defaultContent;
                    }

                    if (scope.translations[scope.container][scope.key] !== undefined) {
                        return $sce.trustAsHtml(scope.translations[scope.container][scope.key]);
                    }
                    else if (scope.translations[scope.container][scope.key] !== undefined) {                                                
                        return $sce.trustAsHtml(scope.translations[scope.container][scope.key.toLowerCase()]);
                    }
                    else {
                        return scope.defaultContent;
                    }                        
                }
            }
        };
    });